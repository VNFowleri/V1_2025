<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search Providers - Veritas One</title>
    <link rel="stylesheet" href="/static/css/styles.css">
</head>
<body>
    <!-- Header -->
    <header class="site-header">
        <div class="container">
            <div class="header-content">
                <a href="/" class="logo">Veritas One</a>
                <nav>
                    <ul class="nav-links">
                        <li><span class="text-muted">Welcome, {{ patient.first_name }}</span></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <section>
        <div class="container container-narrow">
            <div class="text-center mb-xl">
                <h1 style="margin-bottom: var(--space-sm);">Find Your Healthcare Providers</h1>
                <p class="text-muted">Search for hospitals and clinics where you've received care</p>
            </div>

            {% if error %}
            <div class="alert alert-error">
                <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                    <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM5.354 4.646a.5.5 0 1 0-.708.708L7.293 8l-2.647 2.646a.5.5 0 0 0 .708.708L8 8.707l2.646 2.647a.5.5 0 0 0 .708-.708L8.707 8l2.647-2.646a.5.5 0 0 0-.708-.708L8 7.293 5.354 4.646z"/>
                </svg>
                <span>{{ error }}</span>
            </div>
            {% endif %}

            <!-- Search Form -->
            <form method="post" action="/search-providers/{{ patient.id }}" class="form">
                <div class="card">
                    <h3 style="margin-bottom: var(--space-lg);">Search by Hospital Name</h3>
                    
                    <div class="form-field">
                        <label for="search_query">Hospital or Medical Center Name</label>
                        <input 
                            type="text" 
                            id="search_query" 
                            name="search_query" 
                            placeholder="e.g., Massachusetts General Hospital, Mayo Clinic"
                            value="{{ search_query or '' }}"
                        >
                        <p class="text-small text-muted mt-sm">
                            Enter the name of any hospital, clinic, or medical center
                        </p>
                    </div>
                </div>

                <div style="text-align: center; margin: var(--space-xl) 0;">
                    <span style="display: inline-block; padding: var(--space-sm) var(--space-lg); background: var(--paper); border-radius: 50px; font-weight: 600; color: var(--ink-medium); font-size: 0.875rem;">
                        OR
                    </span>
                </div>

                <div class="card">
                    <h3 style="margin-bottom: var(--space-lg);">Search by Location</h3>
                    
                    <div class="form-row">
                        <div class="form-field">
                            <label for="city">City</label>
                            <input 
                                type="text" 
                                id="city" 
                                name="city" 
                                placeholder="e.g., Boston"
                                value="{{ city or '' }}"
                            >
                        </div>

                        <div class="form-field">
                            <label for="state">State</label>
                            <input 
                                type="text" 
                                id="state" 
                                name="state" 
                                placeholder="e.g., MA"
                                maxlength="2"
                                style="text-transform: uppercase;"
                                value="{{ state or '' }}"
                            >
                        </div>
                    </div>

                    <div class="form-field">
                        <label for="zip_code">ZIP Code</label>
                        <input 
                            type="text" 
                            id="zip_code" 
                            name="zip_code" 
                            placeholder="e.g., 02114"
                            pattern="[0-9]{5}"
                            maxlength="5"
                            value="{{ zip_code or '' }}"
                        >
                    </div>
                </div>

                <div style="background: var(--medical-blue-subtle); padding: var(--space-lg); border-radius: 12px; border-left: 4px solid var(--medical-blue); margin: var(--space-xl) 0;">
                    <p class="text-small mb-sm" style="color: var(--ink-medium); font-weight: 600;">
                        ðŸ’¡ Search Tips
                    </p>
                    <ul style="margin: 0; padding-left: var(--space-lg); color: var(--ink-medium); font-size: 0.875rem; line-height: 1.6;">
                        <li>Try searching by hospital name for fastest results</li>
                        <li>Use city and state to find all facilities in an area</li>
                        <li>You can search multiple times to add more providers</li>
                        <li>We'll automatically find fax numbers when possible</li>
                    </ul>
                </div>

                <div class="form-actions">
                    <button type="button" onclick="window.history.back()" class="btn btn-ghost">
                        Back
                    </button>
                    <button type="submit" class="btn btn-primary btn-large">
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                        </svg>
                        Search Providers
                    </button>
                </div>
            </form>

            <!-- Progress Indicator -->
            <div style="max-width: 600px; margin: var(--space-2xl) auto;">
                <div style="display: flex; align-items: center; justify-content: center; gap: var(--space-sm);">
                    <div style="width: 32px; height: 32px; background: var(--success); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.875rem;">âœ“</div>
                    <div style="flex: 1; height: 2px; background: var(--success);"></div>
                    <div style="width: 32px; height: 32px; background: var(--success); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.875rem;">âœ“</div>
                    <div style="flex: 1; height: 2px; background: var(--medical-blue);"></div>
                    <div style="width: 32px; height: 32px; background: var(--medical-blue); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.875rem;">3</div>
                    <div style="flex: 1; height: 2px; background: var(--border);"></div>
                    <div style="width: 32px; height: 32px; background: var(--border-subtle); color: var(--ink-lighter); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.875rem;">4</div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: var(--space-sm);">
                    <span class="text-small" style="color: var(--success); font-weight: 600;">Register</span>
                    <span class="text-small" style="color: var(--success); font-weight: 600;">Consent</span>
                    <span class="text-small" style="color: var(--medical-blue); font-weight: 600;">Providers</span>
                    <span class="text-small text-muted">Complete</span>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div>
                    <p class="footer-text">&copy; 2025 Veritas One. HIPAA Compliant Medical Records Service.</p>
                </div>
                <ul class="footer-links">
                    <li><a href="/privacy">Privacy</a></li>
                    <li><a href="/terms">Terms</a></li>
                    <li><a href="/contact">Contact</a></li>
                </ul>
            </div>
        </div>
    </footer>

    <script>
        // Auto-uppercase state input
        const stateInput = document.getElementById('state');
        if (stateInput) {
            stateInput.addEventListener('input', function() {
                this.value = this.value.toUpperCase();
            });
        }

        // Form validation
        const form = document.querySelector('form');
        form.addEventListener('submit', function(e) {
            const searchQuery = document.getElementById('search_query').value.trim();
            const city = document.getElementById('city').value.trim();
            const state = document.getElementById('state').value.trim();
            const zipCode = document.getElementById('zip_code').value.trim();

            if (!searchQuery && !city && !state && !zipCode) {
                e.preventDefault();
                alert('Please enter either a hospital name or a location (city, state, or ZIP code).');
                return false;
            }
        });
    </script>
</body>
</html>
